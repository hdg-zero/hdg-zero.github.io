---
// site/src/pages/index.astro
// Ultra Pro Homepage - Clean version
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import { Image } from 'astro:assets';

const base = import.meta.env.BASE_URL;
const allProjects = await getCollection('projects');
const featuredProjects = allProjects
    .sort((a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf())
    .slice(0, 3);
---

<BaseLayout title="Hippolyte de Guigné — Digital Architect">
    
    <!-- Hero Section -->
    <section class="relative min-h-[100svh] flex items-center justify-center pt-16 pb-20 sm:pt-20 sm:pb-0 overflow-hidden">
        
        <!-- Ambient Orbs -->
        <div class="absolute inset-0 pointer-events-none overflow-hidden">
            <div class="ambient-orb ambient-orb-1 animate-orb"></div>
            <div class="ambient-orb ambient-orb-2 animate-orb" style="animation-delay: -8s;"></div>
            <div class="ambient-orb ambient-orb-3 animate-orb" style="animation-delay: -15s;"></div>
        </div>

        <!-- Grid Pattern Overlay -->
        <div class="absolute inset-0 opacity-[0.02] pointer-events-none"
             style="background-image: linear-gradient(rgba(255,255,255,0.1) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.1) 1px, transparent 1px); background-size: 60px 60px;">
        </div>

        <div class="container mx-auto px-4 sm:px-6 relative z-10">
            <div class="max-w-5xl mx-auto text-center px-2 sm:px-0">
                
                <!-- Main Headline -->
                <h1 class="text-3xl sm:text-5xl md:text-6xl lg:text-7xl xl:text-8xl font-bold tracking-tighter leading-[0.95] mb-6 sm:mb-8 animate-fade-up">
                    <span data-hero-headline>Développer et</span><br/>
                    <span class="text-gradient" data-hero-headline-accent>partager.</span>
                </h1>

                <!-- Subtitle -->
                <p class="text-base sm:text-lg md:text-xl text-[var(--text-secondary)] max-w-3xl mx-auto leading-relaxed mb-8 sm:mb-12 animate-fade-up delay-100" data-hero-subtitle>
                    Ingénieur en systèmes d'information, j'explore au quotidien la nécessité 
                    de la protection des données personnelles et privées, le potentiel de l'IA 
                    générative et toute sorte de sujet touchant de près ou loin aux technologies 
                    de l'information. Retrouvez ici mes projets techniques, mes expérimentations 
                    et mes retours d'expérience.
                </p>
            </div>
        </div>

        <!-- Scroll Indicator -->
        <div class="scroll-indicator hidden sm:flex animate-fade-up delay-300">
            <span class="text-xs uppercase tracking-widest">Scroll</span>
        </div>
    </section>

    <!-- Bento Grid Section -->
    <section id="work" class="py-32 relative">
        <div class="container mx-auto px-4 sm:px-6">
            
            <!-- Section Header -->
            <div class="max-w-2xl mb-16 animate-fade-up">
                <span class="text-[var(--accent-primary)] text-sm font-medium uppercase tracking-widest mb-4 block" data-work-label>
                    Travaux sélectionnés
                </span>
                <h2 class="text-2xl sm:text-4xl md:text-5xl font-bold tracking-tight mb-4">
                    <span data-work-title>Projets</span> <span class="text-gradient" data-work-title-accent>récents</span>
                </h2>
                <p class="text-[var(--text-secondary)] text-base sm:text-lg" data-work-description>
                    Une collection de mes travaux récents — applications web, 
                    design systems et expérimentations créatives.
                </p>
            </div>
            
            <!-- Bento Grid -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4 lg:auto-rows-[200px]">
                
                <!-- Large Feature: Latest Project (2x2) -->
                {featuredProjects[0] && (
                    <a href={`${base}projects/${featuredProjects[0].slug}`} 
                       class="bento-card col-span-1 sm:col-span-2 lg:row-span-2 min-h-[280px] sm:min-h-[320px] lg:min-h-0 p-6 sm:p-8 flex flex-col justify-end group">
                        <div class="absolute inset-0 z-0">
                            {featuredProjects[0].data.cover && (
                                <Image 
                                    src={featuredProjects[0].data.cover} 
                                    alt={featuredProjects[0].data.title} 
                                    class="w-full h-full object-cover opacity-40 group-hover:opacity-60 group-hover:scale-105 transition-all duration-700" 
                                    width={800} 
                                    height={800} 
                                />
                            )}
                            <div class="absolute inset-0 bg-gradient-to-t from-black via-black/60 to-transparent"></div>
                        </div>
                        <div class="relative z-10">
                            <span class="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-medium bg-[var(--accent-primary)] text-white mb-4">
                                <span class="w-1.5 h-1.5 rounded-full bg-white"></span>
                                <span data-work-latest>Dernier</span>
                            </span>
                            <h3 class="text-2xl sm:text-3xl font-bold text-white mb-2 group-hover:text-[var(--accent-secondary)] transition-colors">
                                {featuredProjects[0].data.title}
                            </h3>
                            <p class="text-[var(--text-secondary)] line-clamp-2">
                                {featuredProjects[0].data.description}
                            </p>
                        </div>
                    </a>
                )}

                <!-- Blog Teaser (1x2) -->
                <a href={`${base}blog`} class="bento-card col-span-1 lg:row-span-2 min-h-[180px] lg:min-h-0 p-5 sm:p-6 flex flex-col justify-between group bg-gradient-to-b from-white/[0.02] to-transparent">
                    <div>
                        <div class="w-12 h-12 rounded-2xl bg-gradient-to-br from-[var(--accent-primary)] to-[var(--accent-secondary)] flex items-center justify-center mb-4 group-hover:scale-110 transition-transform">
                            <span class="text-xl">✍️</span>
                        </div>
                        <h3 class="text-lg font-bold text-[var(--text-primary)] mb-2" data-blog-engineering>Blog technique</h3>
                        <p class="text-sm text-[var(--text-muted)]" data-blog-blog-desc>
                            Plongées profondes dans le code et les patterns.
                        </p>
                    </div>
                    <div class="flex items-center gap-2 text-[var(--accent-primary)] text-sm font-medium group-hover:gap-3 transition-all">
                        <span data-blog-read-articles>Lire</span>
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
                        </svg>
                    </div>
                </a>

                <!-- Secondary Project (2x1) -->
                {featuredProjects[1] && (
                    <a href={`${base}projects/${featuredProjects[1].slug}`} 
                       class="bento-card col-span-1 sm:col-span-2 lg:row-span-1 min-h-[100px] lg:min-h-0 p-5 sm:p-6 flex items-center gap-4 sm:gap-6 group">
                        <div class="flex-1 min-w-0">
                            <h3 class="text-xl font-bold text-[var(--text-primary)] mb-1 group-hover:text-[var(--accent-primary)] transition-colors truncate">
                                {featuredProjects[1].data.title}
                            </h3>
                            <p class="text-sm text-[var(--text-secondary)] line-clamp-1">
                                {featuredProjects[1].data.description}
                            </p>
                        </div>
                        <div class="w-12 h-12 rounded-full border border-[var(--glass-border)] flex items-center justify-center group-hover:bg-[var(--accent-primary)] group-hover:border-transparent transition-all duration-300 flex-shrink-0">
                            <svg class="w-5 h-5 text-[var(--text-secondary)] group-hover:text-white transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
                            </svg>
                        </div>
                    </a>
                )}
            </div>

            <!-- View All Projects Link -->
            <div class="flex justify-center mt-12">
                <a href={`${base}projects`} 
                   class="inline-flex items-center gap-2 px-6 py-3 rounded-full glass text-[var(--text-secondary)] hover:text-[var(--text-primary)] transition-all group">
                    <span data-work-view-all>Voir tous les projets</span>
                    <svg class="w-4 h-4 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
                    </svg>
                </a>
            </div>
        </div>
    </section>

</BaseLayout>

<style>
    .ambient-orb {
        position: absolute;
        border-radius: 50%;
        filter: blur(100px);
        pointer-events: none;
    }
    
    .ambient-orb-1 {
        width: 800px;
        height: 800px;
        background: rgba(10, 132, 255, 0.12);
        top: -30%;
        right: -20%;
    }
    
    .ambient-orb-2 {
        width: 600px;
        height: 600px;
        background: rgba(100, 210, 255, 0.06);
        bottom: -20%;
        left: -15%;
    }
    
    .ambient-orb-3 {
        width: 500px;
        height: 500px;
        background: rgba(94, 92, 230, 0.08);
        top: 30%;
        left: 20%;
    }
</style>